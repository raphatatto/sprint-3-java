<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/_layout :: layout(
        content=~{::content},
        title=${motoId != null} ? 'Editar Moto' : 'Nova Moto',
        active='motos'
      )}">
<th:block th:fragment="content">
    <h2 th:text="${motoId != null} ? 'Editar Moto' : 'Cadastrar e Alocar Moto'">Form</h2>

    <form th:action="${motoId != null} ?
                 @{/motos/{id}/atualizar(id=${motoId})} :
                 @{/motos}"
          method="post" th:object="${moto}">

    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <div class="alert danger" th:if="${#fields.hasGlobalErrors()}">
            <ul><li th:each="e : ${#fields.globalErrors()}" th:text="${e}">Erro</li></ul>
        </div>

        <label>Placa
            <input th:field="*{placa}" required/>
            <small class="err" th:if="${#fields.hasErrors('placa')}" th:errors="*{placa}">Erro</small>
        </label>

        <label>Modelo
            <input th:field="*{modelo}" required/>
            <small class="err" th:if="${#fields.hasErrors('modelo')}" th:errors="*{modelo}">Erro</small>
        </label>

        <label>Cor
            <input th:field="*{cor}"/>
            <small class="err" th:if="${#fields.hasErrors('cor')}" th:errors="*{cor}">Erro</small>
        </label>

        <!-- Campo da vaga só no cadastro novo -->
        <div th:if="${motoId == null}">
            <label>Vaga
                <select th:field="*{codigoVaga}">
                    <option value="">(auto - 1ª LIVRE)</option>
                    <option th:each="v : ${vagas}" th:value="${v.codigo}"
                            th:text="${v.codigo + ' - ' + v.setor + ' (' + v.status + ')'}"></option>
                </select>
                <small class="err" th:if="${#fields.hasErrors('codigoVaga')}" th:errors="*{codigoVaga}">Erro</small>
            </label>
        </div>

        <div th:if="${motoId != null}">
            <label>Senha do gerente
                <input name="adminPass" type="password" placeholder="senha gerente" required/>
            </label>
        </div>

        <button class="btn ok" type="submit" th:text="${motoId != null} ? 'Salvar alterações' : 'Salvar'">Salvar</button>
    </form>
</th:block>
</html>
