<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/springsecurity"
      th:replace="~{fragments/_layout :: layout(
        content=~{::content},
        title='Alocações',
        active='alocacoes'
      )}">
<th:block th:fragment="content">
    <h2>Alocações Atuais</h2>
    <table>
        <thead>
        <tr>
            <th>Placa</th><th>Vaga</th><th>Setor</th><th>Início</th><th>Ações</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="a : ${alocacoes}">
            <td th:text="${a.moto.placa}">ABC1D23</td>
            <td th:text="${a.vaga.codigo}">A1</td>
            <td th:text="${a.vaga.setor}">Norte</td>
            <td th:text="${#temporals.format(a.inicio, 'dd/MM/yyyy HH:mm')}">--</td>
            <td>
                <!-- Apenas MANAGER pode encerrar -->
                <form class="inline" th:action="@{|/alocacoes/${a.id}/encerrar|}" method="post" sec:authorize="hasRole('MANAGER')">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <button class="btn danger" type="submit">Encerrar</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>
</th:block>
</html>
